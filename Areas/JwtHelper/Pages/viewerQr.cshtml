@page "/viewer"
@model Identity_JWT_Project.Pages.ViewerModel
@{
    ViewData["Title"] = "Guest Viewer";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <span class="badge bg-success">Verified — Guest Viewer</span>
    <span class="text-muted">Token expires in: <strong id="countdown">@Model.SecondsLeft</strong>s</span>
</div>

<div class="card mb-3">
    <div class="card-header">Live Metrics</div>
    <div class="card-body">
        <ul class="list-unstyled mb-0">
            <li>Users total: <strong>@Model.Metrics.Users</strong></li>
            <li>Active roles: <strong>@Model.Metrics.Roles</strong></li>
            <li>Last sign-in (UTC): <strong>@Model.Metrics.LastSignInUtc</strong></li>
        </ul>
    </div>
</div>

<div class="d-flex gap-2">
    <button class="btn btn-secondary" disabled data-bs-toggle="tooltip" title="Guest mode — read-only">Edit</button>
    <button class="btn btn-danger" disabled data-bs-toggle="tooltip" title="Guest mode — read-only">Delete</button>
</div>

@section Scripts {
    <script>
        // عدّ تنازلي بسيط
        let s = parseInt(document.getElementById('countdown').textContent || '0', 10);
        const el = document.getElementById('countdown');
        const t = setInterval(() => {
          s = Math.max(0, s-1);
          el.textContent = s;
          if (s <= 0) { clearInterval(t); location.href = '/viewer/expired'; }
        }, 1000);
    </script>
}
